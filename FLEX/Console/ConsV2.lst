
                      ;* EC6809 CONSOLE I/O DRIVER

 F000                 JSWIVE  EQU     $F000      ; SWI3 VECTOR LOCATION (SET 
INTO ROM LIKE IN FAG)
 F000                 JIRQVE  EQU     $F000      ; IRQ VECTOR LOCATION  (SET 
INTO ROM LIKE IN FAG)

 F033                 WTLDVI  EQU     $F033      ; GET // DATA INPUT
 F036                 INIT    EQU     $F036      ; INIT OF VIA, ACIA, CRTC     
   
 F039                 VIARDY  EQU     $F039      ; TEST // DATA READY        
 F03C                 JMPADR  EQU     $F03C      ; PUT CHAR ON SCREEN
 F03F                 GDTVIE  EQU     $F03F      ; GET // DATA INPUT WITH ECHO
 F030                 ERTI    EQU     $F030      ; RETURN FROM INTERRUPT
 F01B                 ERTS    EQU     $F01B

 CD00                 COLDS   EQU     $CD00

                              ORG     $D3E5

 D3E5 D370            INCHN   FDB     JINCHN     ; INPUT CHARACTER WITHOUT 
ECHO
 D3E7 F030            IHNDLR  FDB     ERTI       ; IRQ INTERRUPT HANDLER
 D3E9 F000            SWIVEC  FDB     JSWIVE     ; SWI3 VECTOR LOCATION
 D3EB F000            IRQVEC  FDB     JIRQVE     ; IRQ VECTOR LOCATION
 D3ED F01B            TMOFF   FDB     ERTS       ; TIMER OFF ROUTINE
 D3EF F01B            TMON    FDB     ERTS       ; TIMER ON ROUTINE
 D3F1 F01B            TMINT   FDB     ERTS       ; TIMER INITIALIZATION
 D3F3 D385            MONITR  FDB     JMONIT     ; MONITOR ENTRY ADDRESS
 D3F5 F01B            TINIT   FDB     ERTS       ; TERMINAL INITIALIZATION
 D3F7 D37E            STAT    FDB     JSTAT      ; CHECK TERMINAL STATUS
 D3F9 F03C            OUTCH   FDB     JMPADR     ; OUTPUT CHARACTER
 D3FB D377            INCH    FDB     JINCH      ; INPUT CHARACTER WITH ECHO

                              ORG     $D370

                      ;* INPUT CHARACTER WITHOUT ECHO
 D370 BDF033          JINCHN  JSR     WTLDVI   
 D373 847F                    ANDA    #$7F       ; CLEAR PARITY BIT
 D375 3580                    PULS    PC

                      ;* INPUT CHARACTER WITH ECHO
 D377 BDF03F          JINCH   JSR     GDTVIE
 D37A 847F                    ANDA    #$7F       ; CLEAR PARITY BIT
 D37C 3580                    PULS    PC

                      ;* CHECK VIA STATUS (IF CHAR IS WAITING Z=1, ELSE Z=0)   
   
 D37E 3402            JSTAT   PSHS    A
 D380 BDF039                  JSR     VIARDY
 D383 3582                    PULS    A,PC 
                              
                      ;* MONITOR ENTRY ADDRESS
 D385 3F              JMONIT  SWI             
 D386 08                      FCB     $08

                      ;* CHANGE DEFAULT MEMEND VALUE (AS PER FAG)
                              ORG     $CC2B
 CC2B BEFF                    FCB     $BE,$FF

 CD00                                 END             COLDS

SYMBOL TABLE
     COLDS 00 CD00      ERTI 00 F030      ERTS 00 F01B    GDTVIE 00 F03F
    IHNDLR 02 D3E7      INCH 02 D3FB     INCHN 02 D3E5      INIT 00 F036
    IRQVEC 02 D3EB     JINCH 02 D377    JINCHN 02 D370    JIRQVE 00 F000
    JMONIT 02 D385    JMPADR 00 F03C     JSTAT 02 D37E    JSWIVE 00 F000
    MONITR 02 D3F3     OUTCH 02 D3F9      STAT 02 D3F7    SWIVEC 02 D3E9
     TINIT 02 D3F5     TMINT 02 D3F1     TMOFF 02 D3ED      TMON 02 D3EF
    VIARDY 00 F039    WTLDVI 00 F033
26 SYMBOLS

0 error(s), 0 warning(s)
